{% extends "base.html" %}
{% block title %}Client Onboarding{% endblock %}
{% block content %}
<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Clients for Onboarding</h2>
    <a href="{% url 'client_onboarding_add' %}" class="btn" style="background:#142f44; color:#fff;">Add Client</a>
  </div>

  <table class="table table-bordered">
    <thead>
      <tr>
        <th>Client Name</th>
        <th>Client Phone Number</th>
        <th>Description</th>
        <th>Plan</th>
        <th>Assigned To</th>
        <th>Assigned Phone</th>       
        <th>Deadline (Days)</th> 
        <th>Added</th>
        <th>status</th>
        <th>Delete</th>
      </tr>
    </thead>
    <tbody>
        {% for client in clients %}
        
          {% csrf_token %}
          <tr>
            <td>{{ client.client_name }}</td>
            <td>{{ client.client_phone }}</td>
            <td>{{ client.description }}</td>
            <td>{{ client.plan }}</td>
            <td>{{ client.assigned_to }}</td>
            <td>{{ client.assigned_phone }}</td>           
            <td>{{ client.onboarding_deadline_days }}</td>
            <td>{{ client.created_at|date:"Y-m-d H:i" }}</td>
            <td>
              <form method="post" action="{% url 'update_client_status' client.id %}">
                {% csrf_token %}
                <select name="status" class="form-select form-select-sm" onchange="this.form.submit()">
                  {% for key, label in client.STATUS_CHOICES %}
                    <option value="{{ key }}" {% if client.status == key %}selected{% endif %}>{{ label }}</option>
                  {% endfor %}
                </select>
              </form>
            </td>
            <td>
              <form method="post" action="{% url 'client_onboarding_delete' client.id %}" onsubmit="return confirm('Are you sure you want to delete this client?');">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger btn-sm">Delete</button>
              </form>
            </td>
          </tr>
        
        {% endfor %}
      </tbody>
      
  </table>
</div>
{% endblock %}
